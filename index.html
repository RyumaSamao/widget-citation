<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Player Citations One Piece</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet" />
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
}
body {
  background: #191919;
  color: white;
  font-family: 'Bangers', cursive;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

/* Zone des citations */
.quote-container {
  max-width: 1000px;
  text-align: center;
  margin-bottom: 20px;
  padding: 0 20px;
}
.quote-text {
  font-size: clamp(18px, 2.3vw, 26px);
  line-height: 1.6;
  letter-spacing: 1px;
  user-select: none;
  opacity: 1;
  transition: opacity 1s ease-in-out;
  white-space: normal;
  word-wrap: break-word;
}
.quote-text.long-quote {
  font-size: clamp(14px, 2vw, 18px);
}
.quote-text.fade-out {
  opacity: 0;
}

.quote-author {
  font-size: clamp(18px, 2.3vw, 26px);
  margin-top: 8px;
  opacity: 1;
  transition: opacity 1s ease-in-out;
}
.quote-author.fade-out {
  opacity: 0;
}

/* Bloc des contrôles */
.controls {
  display: flex;
  align-items: center;
  gap: 15px;
  flex-wrap: nowrap;
}

/* Boutons rectangulaires */
button.control-btn {
  background: transparent;
  border: 2px solid white;
  color: white;
  font-family: 'Bangers', cursive;
  cursor: pointer;
  user-select: none;
  transition: background 0.3s, color 0.3s;
  height: 60px;
  padding: 0 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 28px;
  border-radius: 6px;
}
button.control-btn:hover {
  background: white;
  color: #191919;
}

/* Doubles flèches épaisses */
#prevBtn, #nextBtn {
  font-weight: 900;
  font-size: 32px;
}

/* Bouton lecture/lecture auto */
#playPauseBtn svg {
  width: 32px;
  height: 32px;
}
#playPauseBtn:hover svg {
  fill: #191919;
}

/* Bouton audio rond */
.btn-audio {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 2px solid white;
  background: transparent;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: background 0.3s, transform 0.2s;
}
.btn-audio:hover {
  background: white;
}
.btn-audio svg {
  fill: white;
  width: 28px;
  height: 28px;
  transition: fill 0.3s;
}
.btn-audio:hover svg {
  fill: #191919;
}

/* Responsive mobile */
@media (max-width: 768px) {
  .quote-container {
    max-width: 90%;
  }
  .controls {
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
  button.control-btn, .btn-audio {
    height: 50px;
    font-size: 24px;
  }
  #playPauseBtn svg, .btn-audio svg {
    width: 24px;
    height: 24px;
  }
}
</style>
</head>
<body>

<div class="quote-container">
  <div id="quote" class="quote-text"></div>
  <div id="author" class="quote-author"></div>
</div>

<div class="controls">
  <button id="prevBtn" class="control-btn" aria-label="Citation précédente">≪</button>
  <button id="playPauseBtn" class="control-btn" aria-label="Pause la rotation">
    <svg viewBox="0 0 24 24" id="playPauseIcon">
      <polygon points="7,5 19,12 7,19"></polygon>
    </svg>
  </button>
  <button id="nextBtn" class="control-btn" aria-label="Citation suivante">≫</button>
  <button id="audioBtn" class="btn-audio" aria-label="Jouer/arrêter audio" title="Jouer/arrêter audio">
    <svg viewBox="0 0 24 24" id="audioIcon">
      <polygon points="8,5 19,12 8,19"></polygon>
    </svg>
  </button>
</div>

<script>
const quotes = [
  {text: "Kaizoku-Ō ni naru otoko da !!!", author: "Monkey D. Luffy", audio: null},
  {text: "Connaître le passé, c'est connaître l'avenir", author: "Nico Robin", audio: null},
  {text: "Le monde est un théâtre où seuls les forts dictent les règles", author: "Donquixote Doflamingo", audio: null},
  {text: "Rien ne peut les arrêter, et il en sera ainsi tant qu’il y aura des hommes prêts à donner un sens au mot \"Liberté\"", author: "Gol D. Roger", audio: null},
  {text: "Un pirate doit être fier de son nom. Tâchez de vous souvenir du mien", author: "Monkey D. Luffy", audio: null},
  {text: "Ne pas voir la pourriture de ce monde est un plaisir uniquement connu des aveugles", author: "Fujitora", audio: null},
  {text: "Il y a des batailles qu'on ne gagne pas avec les poings", author: "Marshall D. Teach", audio: null},
  {text: `Quand croyez-vous qu’un homme meurt ?
Quand il se prend une balle en plein cœur ? Non !
Quand il est atteint d’une maladie incurable ? Non !
Quand il a avalé une soupe de champignons vénéneux ? NON !
… Un homme meurt lorsque son souvenir tombe dans l’oubli !`, author: "Dr Hiluluk", audio: null},
  {text: "Le vainqueur définira la signification de la justice !", author: "Donquixote Doflamingo", audio: null},
  {text: "Le One Piece EXISTE !!!", author: "Edward Newgate", audio: null},
  {text: "Si nous perdons notre crédibilité en admettant nos erreurs, alors nous n'en avions pas en premier lieu", author: "Fujitora", audio: null}
];

let currentIndex = 0;
let rotationActive = true;
let rotationTimer;
let audioPlaying = false;
let audio = new Audio();
let availableIndexes = [...quotes.keys()];
let history = [];
let historyIndex = -1;

const quoteEl = document.getElementById('quote');
const authorEl = document.getElementById('author');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const playPauseBtn = document.getElementById('playPauseBtn');
const playPauseIcon = document.getElementById('playPauseIcon');
const audioBtn = document.getElementById('audioBtn');
const audioIcon = document.getElementById('audioIcon');

function getNextRandomIndex() {
  if (availableIndexes.length === 0) availableIndexes = [...quotes.keys()];
  const randomIdx = Math.floor(Math.random() * availableIndexes.length);
  return availableIndexes.splice(randomIdx, 1)[0];
}

function showQuote(index) {
  quoteEl.classList.add('fade-out');
  authorEl.classList.add('fade-out');
  setTimeout(() => {
    currentIndex = index;
    if (quotes[index].text.length > 200) quoteEl.classList.add('long-quote');
    else quoteEl.classList.remove('long-quote');
    quoteEl.textContent = quotes[index].text;
    authorEl.textContent = `- ${quotes[index].author}`;
    quoteEl.classList.remove('fade-out');
    authorEl.classList.remove('fade-out');
  }, 900);
}

function showNextQuote() {
  if (historyIndex < history.length - 1) {
    historyIndex++;
    showQuote(history[historyIndex]);
  } else {
    const nextIdx = getNextRandomIndex();
    history.push(nextIdx);
    historyIndex++;
    showQuote(nextIdx);
  }
}

function showPrevQuote() {
  if (historyIndex > 0) {
    historyIndex--;
    showQuote(history[historyIndex]);
  }
}

function startRotation() {
  rotationActive = true;
  playPauseIcon.innerHTML = `<rect x="6" y="5" width="4" height="14"/><rect x="14" y="5" width="4" height="14"/>`;
  rotationTimer = setTimeout(() => {
    showNextQuote();
    if (rotationActive) startRotation();
  }, 10000);
}

function stopRotation() {
  rotationActive = false;
  playPauseIcon.innerHTML = `<polygon points="7,5 19,12 7,19"/>`;
  clearTimeout(rotationTimer);
}

function toggleRotation() {
  if (rotationActive) stopRotation();
  else startRotation();
}

function toggleAudio() {
  if (audioPlaying) {
    audio.pause();
    audio.currentTime = 0;
    audioPlaying = false;
    audioIcon.innerHTML = `<polygon points="8,5 19,12 8,19"></polygon>`;
  } else {
    audio.src = '';
    audio.play().catch(()=>{});
    audioPlaying = true;
    audioIcon.innerHTML = `<rect x="6" y="5" width="4" height="14" /><rect x="14" y="5" width="4" height="14" />`;
  }
}

prevBtn.addEventListener('click', ()=>{ stopRotation(); showPrevQuote(); });
nextBtn.addEventListener('click', ()=>{ stopRotation(); showNextQuote(); });
playPauseBtn.addEventListener('click', toggleRotation);
audioBtn.addEventListener('click', toggleAudio);

showNextQuote();
startRotation();
</script>

</body>
</html>
